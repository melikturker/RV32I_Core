MODULE=Core
V_SRC=src/Core.v
# Add all source files to compilation
V_SRCS=src/*.v

# Verilator Flags
# -CFLAGS to include nothing special for headless
V_FLAGS=--cc --exe --build -j 4 -Wno-fatal -Wno-CASEINCOMPLETE -Wno-WIDTHTRUNC

.PHONY: all clean run

all: obj_dir/V$(MODULE)_headless

obj_dir/V$(MODULE)_headless: sim/sim_headless.cpp $(V_SRCS)
	# Compile with specific output executable name if possible, or just default
	verilator $(V_FLAGS) $(V_SRCS) sim/sim_headless.cpp --top-module $(MODULE) -o V$(MODULE)_headless

run: all
	./obj_dir/V$(MODULE)_headless

clean:
	rm -rf obj_dir
